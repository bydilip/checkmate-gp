<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Debug</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{background:#000;color:#fff;font-family:sans-serif;padding:20px}
#log{font-size:12px;white-space:pre-wrap;margin-top:10px;background:#111;padding:10px;border-radius:8px;max-height:60vh;overflow:auto}
.board-wrapper{width:100%;max-width:400px;margin:10px auto}
.board-container{width:100%;aspect-ratio:1/1;position:relative;overflow:hidden;border:2px solid gold}
.board{position:absolute;top:0;left:0;right:0;bottom:0;display:grid;grid-template-columns:repeat(8,1fr);grid-template-rows:repeat(8,1fr)}
.sq{display:flex;align-items:center;justify-content:center}
.sq.l{background:#D9CBAA}
.sq.d{background:#302820}
.sq span{font-size:min(4vw,24px)}
</style>
</head>
<body>
<h3 style="color:gold">Checkmate GP Debug</h3>
<div id="log">Starting...\n</div>
<div class="board-wrapper">
<div class="board-container">
<div class="board" id="board"></div>
</div>
</div>

<script>
var log=document.getElementById('log');
function L(msg){log.textContent+=msg+'\n';log.scrollTop=log.scrollHeight;}

try{
  L('Step 1: Document ready');
  
  var b=document.getElementById('board');
  L('Step 2: Board element found: '+(b?'YES':'NO'));
  L('Step 2b: Board dimensions: '+b.offsetWidth+'x'+b.offsetHeight);
  
  var pieces='♜♞♝♛♚♝♞♜';
  var pawns='♟♟♟♟♟♟♟♟';
  var wpieces='♖♘♗♕♔♗♘♖';
  var wpawns='♙♙♙♙♙♙♙♙';
  
  var rows=[pieces,pawns,'','','','',wpawns,wpieces];
  var count=0;
  
  for(var r=0;r<8;r++){
    for(var c=0;c<8;c++){
      var sq=document.createElement('div');
      sq.className='sq '+((r+c)%2===0?'l':'d');
      if(rows[r]&&rows[r][c]){
        var s=document.createElement('span');
        s.textContent=rows[r][c];
        sq.appendChild(s);
      }
      b.appendChild(sq);
      count++;
    }
  }
  
  L('Step 3: Created '+count+' squares');
  L('Step 4: Board children: '+b.children.length);
  L('Step 5: Board computed size: '+b.getBoundingClientRect().width+'x'+b.getBoundingClientRect().height);
  L('Step 6: Container size: '+b.parentElement.getBoundingClientRect().width+'x'+b.parentElement.getBoundingClientRect().height);
  L('Step 7: Wrapper size: '+b.parentElement.parentElement.getBoundingClientRect().width+'x'+b.parentElement.parentElement.getBoundingClientRect().height);
  L('Step 8: Window size: '+window.innerWidth+'x'+window.innerHeight);
  L('Step 9: UserAgent: '+navigator.userAgent);
  
  // Test SVG rendering
  var testSq=b.children[0];
  var svgTest=document.createElement('div');
  svgTest.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 45 45" width="30" height="30"><circle cx="22" cy="22" r="10" fill="red"/></svg>';
  testSq.appendChild(svgTest);
  L('Step 10: SVG injected into first square');
  
  // Test Web Worker
  try{
    var wCode='self.onmessage=function(e){self.postMessage("ok");}';
    var wBlob=new Blob([wCode],{type:'application/javascript'});
    var w=new Worker(URL.createObjectURL(wBlob));
    w.onmessage=function(e){L('Step 11: Worker responded: '+e.data);w.terminate();};
    w.onerror=function(e){L('Step 11: Worker ERROR: '+e.message);};
    w.postMessage('test');
  }catch(e){
    L('Step 11: Worker creation failed: '+e.message);
  }
  
  L('Done! If you see a board above, rendering works.');
  
}catch(e){
  L('ERROR: '+e.message+' at line '+e.line);
}
</script>

</body>
</html>